<div class="profile-main">
  <!-- Header -->
  <app-header></app-header>

  <!-- Profile Content -->
  <div class="profile-content">
    <div class="container">
      <div class="profile-wrapper">
        <!-- Profile Header -->
        <div class="profile-header">
          <div class="profile-avatar">
            <div class="avatar-circle">
              <span class="avatar-text">{{ (currentUser?.firstName?.[0] || currentUser?.email?.[0] || 'U').toUpperCase() }}</span>
            </div>
          </div>
          <div class="profile-info">
            <h1 class="profile-name">{{ currentUser?.firstName || '' }} {{ currentUser?.lastName || '' }}</h1>
            <p class="profile-email">{{ currentUser?.email }}</p>
            <div class="profile-badges">
              <span class="badge" *ngIf="currentUser?.roles?.includes('Admin')">Admin</span>
              <span class="badge user-badge">Th√†nh vi√™n</span>
            </div>
          </div>
        </div>

        <!-- Profile Tabs -->
        <div class="profile-tabs">
          <div class="tab-content">
            <!-- Personal Information Tab -->
            <div class="tab-panel active">
              <div class="panel-header">
                <h2 class="panel-title">Th√¥ng tin c√° nh√¢n</h2>
                <p class="panel-description">C·∫≠p nh·∫≠t th√¥ng tin c√° nh√¢n c·ªßa b·∫°n</p>
              </div>

              <form [formGroup]="profileForm" (ngSubmit)="onSubmitProfile()" class="profile-form">
                <div class="form-grid">
                  <div class="form-group">
                    <label for="firstName" class="form-label">H·ªç *</label>
                    <input 
                      type="text" 
                      id="firstName" 
                      formControlName="firstName" 
                      class="form-input"
                      [class.error]="getFieldError(profileForm, 'firstName')"
                      placeholder="Nh·∫≠p h·ªç c·ªßa b·∫°n"
                    />
                    <div class="error-message" *ngIf="getFieldError(profileForm, 'firstName')">
                      {{ getFieldError(profileForm, 'firstName') }}
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="lastName" class="form-label">T√™n *</label>
                    <input 
                      type="text" 
                      id="lastName" 
                      formControlName="lastName" 
                      class="form-input"
                      [class.error]="getFieldError(profileForm, 'lastName')"
                      placeholder="Nh·∫≠p t√™n c·ªßa b·∫°n"
                    />
                    <div class="error-message" *ngIf="getFieldError(profileForm, 'lastName')">
                      {{ getFieldError(profileForm, 'lastName') }}
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="email" class="form-label">Email *</label>
                    <input 
                      type="email" 
                      id="email" 
                      formControlName="email" 
                      class="form-input"
                      [class.error]="getFieldError(profileForm, 'email')"
                      placeholder="Nh·∫≠p email c·ªßa b·∫°n"
                    />
                    <div class="error-message" *ngIf="getFieldError(profileForm, 'email')">
                      {{ getFieldError(profileForm, 'email') }}
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="phoneNumber" class="form-label">S·ªë ƒëi·ªán tho·∫°i</label>
                    <input 
                      type="tel" 
                      id="phoneNumber" 
                      formControlName="phoneNumber" 
                      class="form-input"
                      [class.error]="getFieldError(profileForm, 'phoneNumber')"
                      placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i"
                    />
                    <div class="error-message" *ngIf="getFieldError(profileForm, 'phoneNumber')">
                      {{ getFieldError(profileForm, 'phoneNumber') }}
                    </div>
                  </div>
                </div>

                <div class="form-actions">
                  <button type="submit" class="btn btn-primary" [disabled]="isLoading">
                    <span *ngIf="isLoading" class="loading-spinner"></span>
                    {{ isLoading ? 'ƒêang c·∫≠p nh·∫≠t...' : 'C·∫≠p nh·∫≠t th√¥ng tin' }}
                  </button>
                </div>
              </form>
            </div>

            <!-- Change Password Tab -->
            <div class="tab-panel">
              <div class="panel-header">
                <h2 class="panel-title">ƒê·ªïi m·∫≠t kh·∫©u</h2>
                <p class="panel-description">Thay ƒë·ªïi m·∫≠t kh·∫©u ƒë·ªÉ b·∫£o m·∫≠t t√†i kho·∫£n c·ªßa b·∫°n</p>
              </div>

              <form [formGroup]="passwordForm" (ngSubmit)="onSubmitPassword()" class="password-form">
                <div class="form-group">
                  <label for="currentPassword" class="form-label">M·∫≠t kh·∫©u hi·ªán t·∫°i *</label>
                  <div class="password-input-group">
                    <input 
                      [type]="showPassword ? 'text' : 'password'" 
                      id="currentPassword" 
                      formControlName="currentPassword" 
                      class="form-input"
                      [class.error]="getFieldError(passwordForm, 'currentPassword')"
                      placeholder="Nh·∫≠p m·∫≠t kh·∫©u hi·ªán t·∫°i"
                    />
                    <button type="button" class="password-toggle" (click)="togglePasswordVisibility('current')">
                      <i class="eye-icon">{{ showPassword ? 'ÔøΩÔøΩÔ∏è' : 'üëÅÔ∏è‚Äçüó®Ô∏è' }}</i>
                    </button>
                  </div>
                  <div class="error-message" *ngIf="getFieldError(passwordForm, 'currentPassword')">
                    {{ getFieldError(passwordForm, 'currentPassword') }}
                  </div>
                </div>

                <div class="form-group">
                  <label for="newPassword" class="form-label">M·∫≠t kh·∫©u m·ªõi *</label>
                  <div class="password-input-group">
                    <input 
                      [type]="showNewPassword ? 'text' : 'password'" 
                      id="newPassword" 
                      formControlName="newPassword" 
                      class="form-input"
                      [class.error]="getFieldError(passwordForm, 'newPassword')"
                      placeholder="Nh·∫≠p m·∫≠t kh·∫©u m·ªõi (√≠t nh·∫•t 6 k√Ω t·ª±)"
                    />
                    <button type="button" class="password-toggle" (click)="togglePasswordVisibility('new')">
                      <i class="eye-icon">{{ showNewPassword ? 'üëÅÔ∏è' : 'üëÅÔ∏è‚Äçüó®Ô∏è' }}</i>
                    </button>
                  </div>
                  <div class="error-message" *ngIf="getFieldError(passwordForm, 'newPassword')">
                    {{ getFieldError(passwordForm, 'newPassword') }}
                  </div>
                </div>

                <div class="form-group">
                  <label for="confirmPassword" class="form-label">X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi *</label>
                  <div class="password-input-group">
                    <input 
                      [type]="showConfirmPassword ? 'text' : 'password'" 
                      id="confirmPassword" 
                      formControlName="confirmPassword" 
                      class="form-input"
                      [class.error]="getFieldError(passwordForm, 'confirmPassword')"
                      placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi"
                    />
                    <button type="button" class="password-toggle" (click)="togglePasswordVisibility('confirm')">
                      <i class="eye-icon">{{ showConfirmPassword ? 'üëÅÔ∏è' : 'üëÅÔ∏è‚Äçüó®Ô∏è' }}</i>
                    </button>
                  </div>
                  <div class="error-message" *ngIf="getFieldError(passwordForm, 'confirmPassword')">
                    {{ getFieldError(passwordForm, 'confirmPassword') }}
                  </div>
                </div>

                <div class="password-requirements">
                  <h4>Y√™u c·∫ßu m·∫≠t kh·∫©u:</h4>
                  <ul>
                    <li>√çt nh·∫•t 6 k√Ω t·ª±</li>
                    <li>Kh√¥ng ƒë∆∞·ª£c tr√πng v·ªõi m·∫≠t kh·∫©u hi·ªán t·∫°i</li>
                    <li>N√™n bao g·ªìm ch·ªØ hoa, ch·ªØ th∆∞·ªùng v√† s·ªë</li>
                  </ul>
                </div>

                <div class="form-actions">
                  <button type="submit" class="btn btn-primary" [disabled]="isPasswordLoading">
                    <span *ngIf="isPasswordLoading" class="loading-spinner"></span>
                    {{ isPasswordLoading ? 'ƒêang ƒë·ªïi m·∫≠t kh·∫©u...' : 'ƒê·ªïi m·∫≠t kh·∫©u' }}
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <app-footer></app-footer>
</div>
